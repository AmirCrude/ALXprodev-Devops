#!/bin/bash

JSON_FILE="data.json"

[ ! -f "$JSON_FILE" ] && echo "Error: $JSON_FILE not found." >&2 && exit 1

# Read all values at once
read name height_dm weight_hg type_raw <<< $(./bin/jq.exe -r '
    .name + " " + 
    (.height|tostring) + " " + 
    (.weight|tostring) + " " + 
    .types[0].type.name
' "$JSON_FILE")

# Format height (dm → m)
formatted_height=$(awk -v h="$height_dm" 'BEGIN {
    val = h / 10
    if (val == int(val))
        printf "%d", val
    else
        printf "%.1f", val
}')

# Format weight (hg → kg)
formatted_weight=$(awk -v w="$weight_hg" 'BEGIN {
    val = w / 10
    if (val == int(val))
        printf "%d", val
    else
        printf "%.1f", val
}')

# Capitalize using sed
name=$(echo "$name" | sed 's/^./\u&/')
type=$(echo "$type_raw" | sed 's/^./\u&/')

# Output exactly as required
echo "$name is of type $type, weighs ${formatted_weight}kg, and is ${formatted_height}m tall."